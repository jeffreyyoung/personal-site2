{"post":{"html":"<p>I recently was trying to write a simple svg animation for a client.  To finish the animation I needed to animate a circle along a bezier path.  I quickly found  <a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Element/animateMotion\"><animateMotion></a> which made doing such an animation simple, but soon learned <code>animateMotion</code> is not supported by any versions of Internet Explorer. Since I had trouble finding any straight forward ways to do the animation using css, I decided to write the animation using javascript. Which brings us to:</p>\n<h3>How to animate a svg circle along an svg path using javascript.</h3>\n<p>To do our animation we'll write a function that will execute one &quot;step&quot; of our animation, and call that function repeatedly throughout the duration of our animation.  To help our animation to be more performant, we'll do all dom mutations within a callback function passed into  <code>requestAnimationFrame</code>.  Letting the browser call our animation function via <code>requestAnimationFrame</code> allows the browser to batch dom manipulations together, resulting in fewer unnecessary repaints, which means a more performant animation.</p>\n<pre><code class=\"language-javascript\">\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">animateProgress</span>(<span class=\"hljs-params\">duration <span class=\"hljs-regexp\">/*duration of animation*/</span>, animateElement <span class=\"hljs-regexp\">/*callback function to animate our javascript element*/</span></span>) </span>{\n  <span class=\"hljs-keyword\">var</span> start = <span class=\"hljs-literal\">null</span>;\n\n  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">step</span>(<span class=\"hljs-params\">timestamp</span>) </span>{\n    <span class=\"hljs-keyword\">if</span> (!start) {\n      start = timestamp;\n    }\n    <span class=\"hljs-keyword\">var</span> timeSinceAnimationStart = timestamp - start;\n    <span class=\"hljs-keyword\">var</span> percentProgress = timeSinceAnimationStart / duration;\n\n    animateElement(percentProgress);\n    <span class=\"hljs-keyword\">if</span> (timeSinceAnimationStart &lt; duration) {\n      requestAnimationFrame(step);\n    } <span class=\"hljs-keyword\">else</span> {\n      animateElement(<span class=\"hljs-number\">1</span>); <span class=\"hljs-comment\">//animation is Finished :D</span>\n    }\n  }\n\n  requestAnimationFrame(step);\n}\n<span class=\"hljs-comment\">/**\n  from - initial value of animated element at beginning of animation\n  to - final value of animated element at end of animation\n  duration - time in milliseconds of animation\n  animateElement - call back to animate element\n*/</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">animate</span>(<span class=\"hljs-params\">from, to, duration, animateElement</span>) </span>{\n  animateProgress(duration, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">percentProgress</span>) </span>{\n    <span class=\"hljs-keyword\">var</span> nextValue = <span class=\"hljs-keyword\">from</span> + (to - <span class=\"hljs-keyword\">from</span>) * percentProgress;\n    animateElement(nextValue);\n  })\n}\n</code></pre>\n<p>We can use our animate function like so:</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> redSquare = <span class=\"hljs-built_in\">document</span>.getElementById(<span class=\"hljs-string\">'red-square'</span>)\nanimate(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>, <span class=\"hljs-number\">1000</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">nextValue</span>) </span>{\n  redSquare.style.left = nextValue+<span class=\"hljs-string\">'px'</span>;\n})\n</code></pre>\n<iframe height='265' scrolling='no' title='Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/xPWmpM/?height=265&theme-id=0&default-tab=result&embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='https://codepen.io/jeffreyyoung/pen/xPWmpM/'>Animation With requestAnimationFrame</a> by Jeff (<a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>\n<p>In the above code, we are animating the <code>left</code> style of the square element, from 0 to 100, over a period of 1000 milliseconds</p>\n<p>Now if we wanted to animate a svg circle along a path, we could do so with the following code:</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">animateCircleAlongPath</span>(<span class=\"hljs-params\">circle, path</span>) </span>{\n    animate(<span class=\"hljs-number\">0</span>, path.getTotalLength(), <span class=\"hljs-number\">3000</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">currentLengthOnPath</span>) </span>{\n    <span class=\"hljs-keyword\">var</span> nextCoords = path.getPointAtLength(currentLengthOnPath);\n\t\tcircle.setAttribute(<span class=\"hljs-string\">'cx'</span>, nextCoords.x);\n\t\tcircle.setAttribute(<span class=\"hljs-string\">'cy'</span>, nextCoords.y);\n  })\n}\n</code></pre>\n<iframe height='265' scrolling='no' title='SVG Animation With requestAnimationFrame' src='//codepen.io/jeffreyyoung/embed/QOmzXQ/?height=265&theme-id=0&default-tab=result&embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='https://codepen.io/jeffreyyoung/pen/QOmzXQ/'>SVG Animation With requestAnimationFrame</a> by Jeff (<a href='https://codepen.io/jeffreyyoung'>@jeffreyyoung</a>) on <a href='https://codepen.io'>CodePen</a>.\n</iframe>","meta":{"title":"Javascript Alternative to animateMotion","image":"/images/byu-big-data.png","imageDescription":"Screen shot of the current website","category":"blog","id":203948902,"order":10,"description":"How to write a javascript alternative to animateMotion","createdTime":"Wed Nov 22 2017 00:38:32 GMT-0700 (MST)","imagePlaceholder":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAACZ3F9/AAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+0lEQVQokUWSOW8TURSFv/dm3ixexkbZUJgkIiwFoBApQkKio+Cn0tNSAgo1FSESIQsW2MZxMhnP5rdQmJjbHB3d4p7z6fqDwU+nVMDtBEGAUgpjDHmeI6UEwFpLGIZL79/cLJbOOYqioNVqkaYpTdMwHA4RQuCcW6pSCq01stfrLS/FcUxVVdR1zXQ6XURw4Ps+SZLgeR5BELC6uoqMoghVjpjNZstIk8mE/HKCKzIQMDr6QH11QZqmbG5ukiQJsqoqys49yrJEKYUQgjzPEWEEKoRsQOvRK3BzgiBACIGUEj9JEqIoRCcdjDEURYExBoCyrjj//B6XHfP42QHz3QOsMZTZGPn77AefDt9hrWU8HqO1XhJux216+2+I9l5TbLzgy8e3XF5PyI4P8WdzzUa6x5/BKfO5RobtBRPnkErxcv8pVf2E4a/vRLYmK2fQ20LW2hA4OLs4ZXT+jar6R1MIurqmml7jBz47D/dRrTWkVYS9LXzleQDEccj2dp+ZFAjpYYwh05bLk6+UW8/R12dIUrpFTqN85G2fpLuOiFJCI+n3+zRNQ+UEbu0BO702O/d3Wb+zAkZDdYWvtcbzPGQUc9No4s5dRqMRQfD/DbPTI6KNFZo5iFYHIbpI3/cRQgAOMz1Ba40QAmst1lqcc+hknbz0cCxqVVXFX2+N8OIVqCC7AAAAAElFTkSuQmCC"}}}